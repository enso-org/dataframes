import Std.Foreign.C.Value
import Std.Foreign
import Dataframes.Dataframes
import Dataframes.Types 
import Dataframes.Array2D



def f x:
    case x of
        ValueReal r: r*0.776
        ValueText t: throw "invalid type"

def main:
    filename = "./data/simple_empty.csv"
    csv = Dataframe.readFromCSV filename True
    column = csv.selectColumns [0,2]
    json = column.toJSON
    print json

    mpd = column.mapColumn 0 f
    fill = mpd.fillNAColumn 0 3666666
    jsnMpd = fill.toJSON
    print jsnMpd
    column.writeToCSV "./data/write.csv"
    filename2= "./data/sample_xlsx.xlsx"
    xlsx = Dataframe.readFromXlsx filename2 False
    xlsxjsn = xlsx.toJSON
    print xlsxjsn
    xlsx.writeToCSV "./data/newxls.csv"
    None

### META {"metas":[{"marker":4,"meta":{"_displayResult":false,"_selectedVisualizer":null,"_position":{"fromPosition":{"_vector2_y":0,"_vector2_x":0}}}},{"marker":5,"meta":{"_displayResult":false,"_selectedVisualizer":["LunaVisualizer: base: json","base/json/json.html"],"_position":{"fromPosition":{"_vector2_y":0,"_vector2_x":0}}}},{"marker":6,"meta":{"_displayResult":false,"_selectedVisualizer":["LunaVisualizer: base: json","base/json/json.html"],"_position":{"fromPosition":{"_vector2_y":0,"_vector2_x":176}}}},{"marker":7,"meta":{"_displayResult":true,"_selectedVisualizer":["LunaVisualizer: base: json","base/json/json.html"],"_position":{"fromPosition":{"_vector2_y":0,"_vector2_x":352}}}},{"marker":8,"meta":{"_displayResult":true,"_selectedVisualizer":["LunaVisualizer: base: json","base/json/json.html"],"_position":{"fromPosition":{"_vector2_y":176,"_vector2_x":528}}}},{"marker":9,"meta":{"_displayResult":false,"_selectedVisualizer":null,"_position":{"fromPosition":{"_vector2_y":176,"_vector2_x":704}}}},{"marker":10,"meta":{"_displayResult":false,"_selectedVisualizer":null,"_position":{"fromPosition":{"_vector2_y":352,"_vector2_x":528}}}},{"marker":11,"meta":{"_displayResult":false,"_selectedVisualizer":null,"_position":{"fromPosition":{"_vector2_y":0,"_vector2_x":528}}}}]}
